checkout:
  post:
    - git submodule sync
    - git submodule update --init
dependencies:
  override:
    - ant resolve -Divy.useCacheOnly=false
  cache_directories:
    - ~/.ivycache-usrz
test:
  override:
    - ant test -Divy.useCacheOnly=true
deployment:
  integration:
    branch: master
    commands:
      - ant publish
          -Dtask.executed.test=true
          -Divy.useCacheOnly=true
          -Divy.publications="${CIRCLE_ARTIFACTS}"
          -Divy.dirPattern="."
  release:
    branch: release
    commands:
      - ant publish
          -Dtask.executed.test=true
          -Divy.status=release
          -Divy.useCacheOnly=true
          -Divy.publications="${CIRCLE_ARTIFACTS}"
          -Divy.dirPattern="."
